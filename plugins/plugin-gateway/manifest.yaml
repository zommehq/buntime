name: "@buntime/plugin-gateway"
base: "/gateway"
enabled: true

optionalDependencies:
  - "@buntime/plugin-authn"

entrypoint: dist/client/index.html
pluginEntry: dist/plugin.js

menus:
  - icon: lucide:shield
    path: /gateway
    title: Gateway

# Rate limiting configuration
rateLimit:
  requests: 100
  window: "1m"
  keyBy: ip
  excludePaths:
    - "/health"

# Response cache configuration (disabled)
# cache:
#   ttl: 60
#   methods:
#     - GET
#   maxEntries: 1000

# CORS configuration
cors:
  origin: "*"
  methods:
    - GET
    - HEAD
    - PUT
    - PATCH
    - POST
    - DELETE
  credentials: false
  maxAge: 86400
  preflight: true

# Config schema for Rancher UI
config:
  shellDir:
    type: string
    label: Shell Directory
    description: |
      Absolute path to the micro-frontend shell application.
      When configured, all browser navigations are served through this shell.
    example: /data/apps/front-manager/1.0.0
    env: GATEWAY_SHELL_DIR

  shellExcludes:
    type: string
    label: Shell Excludes
    description: |
      Basenames that bypass the shell (comma-separated).
      Requests to these paths go directly to their workers instead of the shell.
      Can also be set via GATEWAY_SHELL_EXCLUDES cookie for per-user overrides.
    example: admin,legacy,reports
    default: cpanel
    env: GATEWAY_SHELL_EXCLUDES

  rateLimit:
    type: object
    label: Rate Limiting
    properties:
      requests:
        type: number
        label: "Rate Limit: Max Requests"
        description: Maximum requests per window
        default: 100
        min: 1
        max: 10000
        env: GATEWAY_RATE_LIMIT_REQUESTS
      window:
        type: enum
        label: "Rate Limit: Time Window"
        default: "1m"
        options:
          - "30s"
          - "1m"
          - "5m"
          - "1h"
        env: GATEWAY_RATE_LIMIT_WINDOW

  cors:
    type: object
    label: CORS
    properties:
      origin:
        type: string
        label: "CORS: Allowed Origins"
        description: "* for all, or comma-separated list"
        default: "*"
        env: GATEWAY_CORS_ORIGIN
      credentials:
        type: boolean
        label: "CORS: Allow Credentials"
        default: false
        env: GATEWAY_CORS_CREDENTIALS
